{"ast":null,"code":"var _jsxFileName = \"/Users/bentait/Desktop/memriio/memriio_web/src/components/memoryviewer/memoryImageViewer.js\";\nimport React from 'react';\nimport videoPlayImg from '../images/dottedcircleplay.png';\nimport videoStopImg from '../images/dottedcircleStop.png';\nimport Hls from 'hls.js'; //import ReactPlayer from 'react-player';\n\nimport './memoryImageViewer.css';\n\nclass MemoryFileViewer extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      videoPlaying: false,\n      fileType: 'empty',\n      // 'image' or 'video' or 'audio' or 'specific' or 'empty'\n      videoLoaded: false\n    };\n\n    this.handleClick = () => {\n      console.log('image clicked');\n    };\n\n    this.stopVideo = () => {\n      this.setState({\n        videoPlaying: false\n      });\n    };\n\n    this.playVideo = () => {\n      this.setState({\n        videoPlaying: true\n      });\n    };\n\n    this.determineFileCategory = memfile => {\n      if (memfile) {\n        if (this.isVideo(memfile.fileext)) {\n          return 'video';\n        } else {\n          if (this.isImage(memfile.fileext)) {\n            return 'image';\n          } else {\n            if (this.isAudio(memfile.fileext)) {\n              return 'audio';\n            } else {\n              return 'specific';\n            }\n          }\n        }\n      } else {\n        return 'empty';\n      }\n    };\n\n    this.isImage = fileExtension => {\n      let ext = fileExtension.toLowerCase();\n      let filetypes = ['jpeg', 'jpg', 'png'];\n      let found = filetypes.indexOf(ext);\n      return !(found === -1);\n    };\n\n    this.isVideo = fileExtension => {\n      let ext = fileExtension.toLowerCase();\n      let filetypes = ['mp4', 'mov', 'm3u8'];\n      let found = filetypes.indexOf(fileExtension);\n      return !(found === -1);\n    };\n\n    this.isAudio = fileExtension => {\n      let ext = fileExtension.toLowerCase();\n      let filetypes = ['m4a', 'wav'];\n      let found = filetypes.indexOf(fileExtension);\n      return !(found === -1);\n    };\n\n    this.renderControls = () => {\n      if (this.props.memfile) {\n        if (this.state.fileType === 'video') {\n          if (this.state.videoPlaying) {\n            return /*#__PURE__*/React.createElement(\"div\", {\n              className: \"buttonPosition\",\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 110,\n                columnNumber: 21\n              }\n            }, /*#__PURE__*/React.createElement(\"img\", {\n              alt: \"Play\",\n              src: videoStopImg,\n              className: 'card-playBtn',\n              onClick: this.stopVideo,\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 111,\n                columnNumber: 25\n              }\n            }));\n          } else {\n            return /*#__PURE__*/React.createElement(\"div\", {\n              className: \"buttonPosition\",\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 122,\n                columnNumber: 21\n              }\n            }, /*#__PURE__*/React.createElement(\"img\", {\n              alt: \"Play\",\n              src: videoPlayImg,\n              className: 'card-playBtn',\n              onClick: this.playVideo,\n              __self: this,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 123,\n                columnNumber: 25\n              }\n            }));\n          }\n        }\n      }\n    };\n\n    this.renderOriginalFile = () => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 9\n        }\n      });\n    };\n\n    this.renderImageThumb = () => {\n      return /*#__PURE__*/React.createElement(\"img\", {\n        alt: \"memory\",\n        src: this.props.memfile.thumburl,\n        className: this.props.thumbStyleClass,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 13\n        }\n      });\n    };\n\n    this.handleVideoReady = () => {\n      console.log('video loaded');\n    };\n\n    this.renderVideo = () => {\n      console.log('rendervideo : ' + JSON.stringify(this.props.memfile.thumburl));\n      return /*#__PURE__*/React.createElement(\"video\", {\n        className: \"videoCanvas\",\n        ref: player => this.player = player,\n        autoPlay: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 9\n        }\n      });\n    };\n  }\n\n  //-----------------------------------------------------------------------------\n  componentDidUpdate() {\n    const video = this.player;\n    const rurl = this.props.memfile.thumburl;\n    const hls = new Hls();\n\n    hls.xhrSetup = function (xhr, url) {\n      xhr.withCredentials = true;\n    };\n\n    console.log('Image Viewer : DidLoad : ' + rurl);\n    hls.loadSource(rurl);\n    hls.attachMedia(video);\n    hls.on(Hls.Events.MANIFEST_PARSED, function () {\n      video.play();\n    });\n  } //-----------------------------------------------------------------------------\n\n\n  //-----------------------------------------------------------------------------\n  render() {\n    const {\n      memfile,\n      alternateRenderer\n    } = this.props;\n    this.state.fileType = this.determineFileCategory(memfile);\n    let visibleContent = null;\n    const controls = this.renderControls();\n    const thumb = memfile ? memfile.thumburl : null;\n\n    if (alternateRenderer) {\n      return alternateRenderer();\n    } else {\n      if (this.state.fileType === 'image') {\n        console.log('FILEVIEWER file is image');\n        visibleContent = this.renderImageThumb();\n      } else if (this.state.fileType === 'video') {\n        console.log('FILEVIEWER file is video');\n        visibleContent = this.renderVideo();\n      } else {\n        visibleContent = null;\n      }\n\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"xover\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 13\n        }\n      }, visibleContent, controls);\n    }\n  }\n\n}\n\n; //-----------------------------------------------------------------------------\n\nexport default MemoryFileViewer;","map":{"version":3,"sources":["/Users/bentait/Desktop/memriio/memriio_web/src/components/memoryviewer/memoryImageViewer.js"],"names":["React","videoPlayImg","videoStopImg","Hls","MemoryFileViewer","Component","state","videoPlaying","fileType","videoLoaded","handleClick","console","log","stopVideo","setState","playVideo","determineFileCategory","memfile","isVideo","fileext","isImage","isAudio","fileExtension","ext","toLowerCase","filetypes","found","indexOf","renderControls","props","renderOriginalFile","renderImageThumb","thumburl","thumbStyleClass","handleVideoReady","renderVideo","JSON","stringify","player","componentDidUpdate","video","rurl","hls","xhrSetup","xhr","url","withCredentials","loadSource","attachMedia","on","Events","MANIFEST_PARSED","play","render","alternateRenderer","visibleContent","controls","thumb"],"mappings":"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","sourcesContent":["import React from 'react';\nimport videoPlayImg from '../images/dottedcircleplay.png'\nimport videoStopImg from '../images/dottedcircleStop.png'\nimport Hls from 'hls.js'\n//import ReactPlayer from 'react-player';\nimport './memoryImageViewer.css';\n\n\nclass MemoryFileViewer extends React.Component{\n\n    state = {\n        videoPlaying:false,\n        fileType:'empty',        // 'image' or 'video' or 'audio' or 'specific' or 'empty'\n        videoLoaded:false,\n\n    }\n\n\n//-----------------------------------------------------------------------------\n\ncomponentDidUpdate() {\n    const video = this.player;\n    const rurl = this.props.memfile.thumburl\n    const hls = new Hls()\n    hls.xhrSetup = function (xhr, url) { xhr.withCredentials = true }\n    \n    console.log('Image Viewer : DidLoad : ' + rurl );\n\n    hls.loadSource(rurl);\n    hls.attachMedia(video);\n    hls.on(Hls.Events.MANIFEST_PARSED, function() { video.play(); });\n}\n\n//-----------------------------------------------------------------------------\n\nhandleClick = () =>{\n    console.log('image clicked')\n    \n}\n\nstopVideo = () => {\n    this.setState({videoPlaying:false})\n    \n}\n//-----------------------------------------------------------------------------\nplayVideo = () => {\n    this.setState({videoPlaying:true})\n}\n\n//-----------------------------------------------------------------------------\n\ndetermineFileCategory = (memfile) => {\n\n    if(memfile){\n        if(this.isVideo(memfile.fileext)){\n            return 'video'\n        }else{\n            if(this.isImage(memfile.fileext)){\n                return 'image'\n            }else{\n                if(this.isAudio(memfile.fileext)){\n                    return 'audio'\n                }else{\n                    return 'specific'\n                }\n            }\n        }\n    }else{\n        return 'empty'\n    }\n}\n\n//-----------------------------------------------------------------------------\n\nisImage= (fileExtension) =>{\n    let ext = fileExtension.toLowerCase()\n    let filetypes = ['jpeg','jpg','png']\n    let found = filetypes.indexOf(ext)\n    return !(found === -1)    \n}\n\n//-----------------------------------------------------------------------------\n\nisVideo= (fileExtension) =>{\n\n    let ext = fileExtension.toLowerCase()\n    let filetypes = ['mp4','mov','m3u8']\n    let found = filetypes.indexOf(fileExtension)\n    return !(found === -1)    \n}\n//-----------------------------------------------------------------------------\n\nisAudio= (fileExtension) =>{\n\n    let ext = fileExtension.toLowerCase()\n    let filetypes = ['m4a','wav']\n    let found = filetypes.indexOf(fileExtension)\n    return !(found === -1)    \n}\n//-----------------------------------------------------------------------------\n\nrenderControls = () => {\n    if(this.props.memfile)\n    {\n        if(this.state.fileType === 'video')\n        {\n            if(this.state.videoPlaying)\n            {\n                return(\n                    <div className='buttonPosition'>\n                        <img \n                            alt=        'Play'\n                            src=        { videoStopImg} \n                            className=  { 'card-playBtn' }\n                            onClick =   { this.stopVideo }\n                        />  \n                    </div>\n                )\n\n            }else{\n                return(\n                    <div className='buttonPosition'>\n                        <img \n                            alt=        'Play'\n                            src=        { videoPlayImg} \n                            className=  { 'card-playBtn' }\n                            onClick =   { this.playVideo }\n                        />  \n                    </div>\n                )\n            }\n            \n        }\n    }\n}\n\n//-----------------------------------------------------------------------------\n\nrenderOriginalFile = () => {\n    return(\n\n        <div className=''>\n            \n        </div>\n    )\n}\n//-----------------------------------------------------------------------------\n\nrenderImageThumb = () => {\n    return (\n        \n            <img \n                alt=         'memory'\n                src=        { this.props.memfile.thumburl } \n                className=  { this.props.thumbStyleClass }\n            />  \n           \n   \n    )\n}\nhandleVideoReady = () => {\n    console.log('video loaded');\n}\n//-----------------------------------------------------------------------------\n\nrenderVideo = () =>{\n    console.log('rendervideo : ' + JSON.stringify(this.props.memfile.thumburl));\n\n    return (\n        <video\n          className=\"videoCanvas\"\n          ref={player => (this.player = player)}\n          autoPlay={true}\n        />\n  )\n}\n\n//-----------------------------------------------------------------------------\n\nrender(){\n    const {memfile,alternateRenderer} = this.props\n    this.state.fileType = this.determineFileCategory(memfile)\n    let visibleContent = null\n\n    const controls = this.renderControls()\n    const thumb = memfile? memfile.thumburl : null        \n\n    if(alternateRenderer) { \n        return ( alternateRenderer() )\n    } else {\n        if(this.state.fileType === 'image') {\n            console.log('FILEVIEWER file is image');\n            visibleContent = this.renderImageThumb()}\n        else if (this.state.fileType === 'video'){\n            console.log('FILEVIEWER file is video');\n            visibleContent = this.renderVideo() \n        }else{\n            visibleContent = null\n        }\n    \n        return (\n            <div className='xover'>\n                {visibleContent}\n                {controls}\n            </div>\n        )\n        \n    }\n}\n\n};\n\n//-----------------------------------------------------------------------------\n\nexport default MemoryFileViewer\n\n"]},"metadata":{},"sourceType":"module"}